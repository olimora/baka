{
    "collab_server" : "",
    "contents" : "<style>\n.notimportant {\n  color: \t#909090;\n}\n\n</style>\n\n```{r set-options, echo=FALSE, cache=FALSE}\noptions(width = 160)\n```\n\nPREDIKCIA VÝROBY ELEKTRINY Z OBNOVITEĽNÝCH ZDROJOV SO ZOHĽADNENÍM EXTERNÝCH FAKTOROV\n========================================================\nauthor: Oliver Moravčík\nfont-family: 'Helvetica'\nwidth: 1152\nheight: 864\nautosize: flase\n\nPrehľad\n========================================================\n- Cieľ\n  - predpovedať produkciu fotovoltaických elektrární na deň dopredu\n- Dáta \n  - meteorologické predpovede od SHMÚ, model Aladin \n  - záznamy z produkcie FVE (fotovoltaických elektrární)\n  - slnečné koordináty / solárne dáta\n- Predikčný model\n  - random forest\n  - výber trénovacej množiny\n- Implementácia\n  - PostgreSQL\n  - R\n\nDáta\n========================================================\n- Aladin\n  - model numerickej predpovede počasia\n  - 24 hodín dopredu \n  - globálne žiarenie\n  - teplota\n  - rýchlosť vetra\n  - celková oblačnosť (%)\n  - relatívna vlhkosť (%)\n  \n***\n- FVE\n  - záznamy priebehu produkcie\n  - vyprodukovaná energia (práca) [kWh]\n  \n<br>\n- Slnečné koordináty / solárne dáta:\n  - elevácia (výška Slnka na oblohe)\n  - dĺžka dňa (dĺžka času, kedy je Slnko v daný deň nad horizontom)\n\n========================================================\n- Aladin\n  - čas v UTC, hodinové kroky\n  - bodové záznamy => konkrétny bod na časovej osi\n  \n<br>\n- FVE\n  - čas v CEST, 15-minutové kroky\n  - intervalové záznamy => záznam z 12:00 = 11:45 až 12:00\n  - niekoľko chybových záznamov/dní\n\n<br> \n- k predpovedi na 12:00 produkcia od 11:30 do 12:30\n  - záznamy z 11:45, 12:00, 12:15 a 12:30\n\nMetriky presnosti\n========================================================\n- odmocnina zo strednej kvadratickej chyby  \n$$ RMSE=\\sqrt{\\frac{1}{N}\\sum_{i=1}^{N}(y_{i,p} - y_{i,s})^n} $$\n- priemerná absolútna chyba   \n$$ MAE=\\frac{1}{N}\\sum_{i=1}^{N}|y_{i,p} - y_{i,s}| $$\n- normalizované (%)\n$$ RRMSE=RMSE*\\frac{100}{\\frac{1}{N}\\sum_{i=1}^{N}y_{i,s}} $$ \n\nRandom forest\n========================================================\n- náhodný les regresných stromov\n- každý strom vytvorený z náhodnej podmnožiny trénovacej množiny\n- každý uzol vytvorený podľa náhodne vybraných vstupných premenných \n- výstup je priemer hlasov\n- náhodný výber do podmnožín má normálne rozdelenie \n  - môžme sa spoľahnúť na priemer\n\nNastavenia modelu\n========================================================\n- veľkosť trénovacej množiny: 30\n- počet vytvorených stromov: 500\n- počet premenných na vytvorenie uzla: 2 z 7\n- minimálna veľkosť listu: 3\n\n- pre každý záznam vytvárame nový les podľa novej vybranej trénovacej množiny\n  \nVýber trénovacej množiny\n========================================================\n- najpodobnejšie hodinové záznamy\n- záznamy hodnotené výpočtom rozdielnosti\n- rozdielnosť vo vstupných premených\n  - voči záznamu, pre ktorý predikujeme\n  - normalizovaná na škálu (rozsah) hodnôt premennej v dátovej množine\n  - násobená faktorom podobnosti danej premennej\n  - takto vypočítané rozdielnosti sú sčítané\n- faktory podobnosti vyjadrujú dôležitosť (váhu) podobnosti v hodnote danej premennej\n\n========================================================\n- $Z$ - záznam, pre ktorý hľadáme najpodobnejšie záznamy\n- $P_{i}$ - i-ty záznam z množiny všetkých záznamov $P$\n- $S_{GHO}$ - škála globálneho žiarenia: $S_{GHO}=max(P_{GHO})-min(P_{GHO})$\n- rozdielnosť i-teho záznamu v globálnom žiarení:\n$$ R_{i,GHO}=\\frac{|Z_{GHO}-P_{i,GHO}|}{S_{GHO}\\times100} $$\n- $F_{GHO}$ - faktor podobnosti pre globálne žiarenie\n- rozdielnosť i-teho záznamu v globálnom žiarení, teplote a rýchlosti vetra:\n$$ R_{i}=(R_{i,GHO}\\times F_{GHO})+(R_{i,T}\\times F_{T})+(R_{i,RV}\\times F_{RV})$$\n\n\nVýsledky\n========================================================\nleft: 50%\n```{r, echo=FALSE}\nvys  <- read.table(header = T, text='nastavenia metrika chyba\n 1 \"30 predch. dní\" rRMSE 29.39\n 2 \"30 predch. dní\" rMAE  23.26\n 3 \"30 najpodob. dní\" rRMSE 24.88\n 4 \"30 najpodob. dní\" rMAE  18.84')\nvys$metrika <- factor(vys$metrika, levels = c(\"rRMSE\", \"rMAE\"))\nvys$nastavenia <- factor(vys$nastavenia, levels = c(\"30 predch. dní\", \"30 najpodob. dní\"))\nlibrary(ggplot2)\nggplot(vys, aes(nastavenia, chyba, fill = metrika)) + \n  geom_bar(stat=\"identity\", position = \"dodge\", show.legend = T) + \n  scale_fill_brewer(palette = \"Set1\") +\n  geom_text(aes(label = chyba, y = chyba), \n            position=position_dodge(width=0.9), vjust=-0.25, size = 9) + \n  theme(text = element_text(size = 25)) +\n  xlab(\"Trénovacia množina\") +\n  ylab(\"Chyba\") + \n  #ggtitle(\"Porovnanie chyby predikcie podľa \\n spôsobu výberu trénovacej množiny\") + \n  scale_y_continuous(limits = c(0, 32))\n```\n***\nPorovnanie:<br>30 predchádzajúcich / 30 najpodobnejších<br><br>\nFaktory podobnosti:<br>\nžiarenie = 90  \nteplota = 10  \nvietor = 1\n\nFaktory podobnosti\n========================================================\n- GHO = 190\n- Celková oblačnosť = 100\n- Teplota vzduchu = 30\n- Rýchlosť vetra = 5,5\n- Relatívna vlhkosť = 1,5\n- Dĺžka slnečného svitu = 53\n- <strong style=\"color:black;\">Elevácia Slnka na oblohe = 1270</strong>\n\n+ Faktor podobnosti elevácie príliš veľký oproti GHO. \nAj malý rozdiel v elevácii zapríčiní nevybratie inak \nveľmi podobného záznamy do trénovacej množiny.\n\n***\n- GHO = 210\n- Celková oblačnosť = 90\n- Teplota vzduchu = 7,5\n- Rýchlosť vetra = 5,5\n- Relatívna vlhkosť = 3,5\n- Dĺžka slnečného svitu = 59\n- <strong style=\"color:black;\">Elevácia Slnka na oblohe = 41\n- q = 6</strong>\n\n+ q - prvotné obmedzenie elevácie +/- 6°\n\nLetná a zimná polovica roka\n========================================================\nleft: 50%\nVýroba - priemer na deň\n```{r, echo=FALSE}\ndf  <- read.table(header = T, text='obdobie vyrobene\n 1 zima 683.3\n 2 leto 1646.8')\ndf$obdobie <- factor(df$obdobie, levels = c(\"zima\", \"leto\"))\nlibrary(ggplot2)\nggplot(data=df, aes(x=obdobie, y=vyrobene)) +\n  geom_bar(stat=\"identity\") + \n geom_text(aes(label = vyrobene, y = vyrobene), \n            position=position_dodge(width=0.9), vjust=-0.25, size = 9) + \n scale_fill_brewer(palette = \"Set1\") + \n  theme(text = element_text(size = 25)) +\n  xlab(\"Obdobie\") +\n  ylab(\"Priem. denná produkcia [kWh]\") + \n  #ggtitle(\"Porovnanie chyby predikcie podľa \\n spôsobu výberu trénovacej množiny\") + \n  scale_y_continuous(limits = c(0, 1800))\n```\n\n***\nChyba predikcie\n```{r, echo=FALSE}\ndf  <- read.table(header = T, text='obdobie metrika chyba\n 1 zima rRMSE 41.39\n 2 zima rMAE  31.77\n 3 leto rRMSE 19.00\n 4 leto rMAE  14.28')\ndf$obdobie <- factor(df$obdobie, levels = c(\"zima\", \"leto\"))\ndf$metrika <- factor(df$metrika, levels = c(\"rRMSE\", \"rMAE\"))\nlibrary(ggplot2)\nggplot(df, aes(obdobie, chyba, fill = metrika)) + \n geom_bar(stat=\"identity\", position = \"dodge\", show.legend = T) + \n scale_fill_brewer(palette = \"Set1\") +\n  geom_text(aes(label = chyba, y = chyba), \n            position=position_dodge(width=0.9), vjust=-0.25, size = 9) + \n  theme(text = element_text(size = 30)) +\n  xlab(\"Obdobie\") +\n  ylab(\"Chyba\") + \n  #ggtitle(\"Porovnanie chyby predikcie podľa \\n spôsobu výberu trénovacej množiny\") + \n  scale_y_continuous(limits = c(0, 45))\n```\n\n========================================================\nV zime:\n- malé hodnoty žiarenia\n- nulové alebo minimálne hodnoty vyprodukovanej energie - zanedbateľné\n\nObmedzenie dátovej množiny:\n- prvá a posledná hodina dňa = východ/západ slnka\n- žiarenie < 120 W/m2\n\n\nmnožina | dáta      | počet hodín | % hodín | % sum(energia)\n--------|-----------|-------------|---------|---------------\n    A   | všetky    |      14 117 |  100.00 |    100.00\n    B   | obmedzené |       9 368 |   66.36 |     93.23\n\n========================================================\nChyba predikcie v rámci dňa\n```{r, echo=FALSE}\ndf  <- read.table(header = T, text='dataset metrika chyba\n 1 A rRMSE 24.37\n 2 A rMAE  18.36\n 3 B rRMSE 23.07\n 4 B rMAE 17.34 ')\ndf$metrika <- factor(df$metrika, levels = c(\"rRMSE\", \"rMAE\"))\nlibrary(ggplot2)\nggplot(df, aes(dataset, chyba, fill = metrika)) + \n geom_bar(stat=\"identity\", position = \"dodge\", show.legend = T) + \n scale_fill_brewer(palette = \"Set1\") +\n  geom_text(aes(label = chyba, y = chyba), \n            position=position_dodge(width=0.9), vjust=-0.25, size = 9) + \n  theme(text = element_text(size = 25)) +\n  xlab(\"Dátová množina\") +\n  ylab(\"Chyba\") + \n  #ggtitle(\"Porovnanie chyby predikcie podľa \\n spôsobu výberu trénovacej množiny\") + \n  scale_y_continuous(limits = c(0, 27))\n```\n\n***\nChyba predikcie v rámci hodiny\n```{r, echo=FALSE}\ndf  <- read.table(header = T, text='dataset metrika chyba\n 1 A rRMSE 44.19\n 2 A rMAE  28.67\n 3 B rRMSE 37.19\n 4 B rMAE 26.91 ')\ndf$metrika <- factor(df$metrika, levels = c(\"rRMSE\", \"rMAE\"))\nlibrary(ggplot2)\nggplot(df, aes(dataset, chyba, fill = metrika)) + \n geom_bar(stat=\"identity\", position = \"dodge\", show.legend = T) + \n scale_fill_brewer(palette = \"Set1\") +\n  geom_text(aes(label = chyba, y = chyba), \n            position=position_dodge(width=0.9), vjust=-0.25, size = 9) + \n  theme(text = element_text(size = 25)) +\n  xlab(\"Dátová množina\") +\n  ylab(\"Chyba\") + \n  #ggtitle(\"Porovnanie chyby predikcie podľa \\n spôsobu výberu trénovacej množiny\") + \n  scale_y_continuous(limits = c(0, 47))\n```\n\n\nZrýchlenie výpočtov v R\n========================================================\n- alokácia pamäti (dopredu, nie postupne)\n- vektorizácia (namiesto cyklov)\n- matica namiesto tabuľky\n- paralelizmus (knižnica snow)\n- Intel(R) Core(TM) i5-2450M CPU @ 2.50GHz<br>\n2 jadrá - 4 thready\n\n***\n```{r, echo=FALSE}\ncasy  <- read.table(header = T, text='sposob sekundy\n 1 \"bez zmien\" 87\n 2 \"matica, alokácia,\\nvektorové funkcie, \" 35\n 3 \"paralelizácia\" 16')\nlibrary(ggplot2)\nggplot(casy, aes(sposob, sekundy, fill = sposob)) + \n  geom_bar(stat=\"identity\", position = \"dodge\", show.legend = F) + \n  geom_text(aes(label = sekundy, y = sekundy), \n            position=position_dodge(width=0.9), vjust=-0.25, size = 9) + \n  scale_fill_brewer(palette = \"Set1\") + \n  theme(text = element_text(size = 25)) +\n  xlab(\"Zmeny v zdrojovom kóde\") +\n  ylab(\"Počet sekúnd\") + \n # ggtitle(\"Porovnanie časov \\n vykonávania skriptu\")+ \n  scale_y_continuous(limits = c(0, 95))\n```\n\n\nOtázky\n========================================================\nMohli by ste uviesť, akú dôležitosť získali jednotlivé vstupné atribúty v metóde regresných stromov náhodného lesa?\n\n- priemerné hodnoty dôležitosti \n- celkovo hodnoty ale veľmi rozdielne, od -10 až po 26\n\n\nmnožina | žiarenie | oblačnosť | teplota | vietor | vlhkosť | dĺžka dňa | elevácia\n--------|----------|-----------|---------|--------|---------|-----------|----------\nA       |       2.2|          1|      3.2|       1|      2.4|        3.6|       4.5\nB       |       1.4|        1.1|      3.6|     1.4|      2.5|        4.1|       2.8\n\n",
    "created" : 1465657884516.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "965314504",
    "id" : "75721A86",
    "lastKnownWriteTime" : 1466496566,
    "last_content_update" : 1466496566812,
    "path" : "~/GitHub/baka/R source/pres/presentation2.Rpres",
    "project_path" : "presentation2.Rpres",
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_presentation"
}